<!DOCTYPE html> <html lang="en" dir="auto"> <head><meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5, user-scalable=no"> <meta name="description" content="Premigration testing Installing MTC Install MTC on your source and target clusters: Check the migration prerequisites. Install MTC on the source an..."> <meta name="revised" content="5c0780b69338e12110ef830cf64ea9376cc6fbec"> <meta name="author" content="Red Hat Communities of Practice"> <meta name="generator" content="jekyll-rtd-theme v2.0.10"><meta name="theme-color" content="#2980b9"> <title>Premigration testing · OpenShift Migration Best Practices</title> <meta name="twitter:title" content="Premigration testing · OpenShift Migration Best Practices"> <meta name="twitter:description" content="Premigration testing Installing MTC Install MTC on your source and target clusters: Check the migration prerequisites. Install MTC on the source an..."> <meta name="twitter:card" content="summary"> <meta name="twitter:site" content="@Red Hat Communities of Practice"> <meta name="twitter:url" content="/openshift-migration-best-practices/03-pre-migration-testing.html"> <meta name="twitter:creator" content="@jekyll-rtd-theme v2.0.10"> <meta property="og:title" content="Premigration testing · OpenShift Migration Best Practices"> <meta property="og:description" content="Premigration testing Installing MTC Install MTC on your source and target clusters: Check the migration prerequisites. Install MTC on the source an..."> <meta property="og:locale" content="en"> <meta property="og:url" content="/openshift-migration-best-practices/03-pre-migration-testing.html"> <meta property="og:type" content="article"> <meta property="article:author" content="Red Hat Communities of Practice"> <meta property="article:published_time" content="2020-08-20T10:18:51-05:00"> <meta property="article:modified_time" content="2021-08-02T19:33:25-05:00"> <script type="application/ld+json"> { "@context": "https://schema.org", "@type": "Article", "mainEntityOfPage": { "@type": "WebPage", "@id": "/openshift-migration-best-practices/03-pre-migration-testing.html" }, "headline": "Premigration testing · OpenShift Migration Best Practices", "image": [], "author": { "@type": "Person", "name": "Red Hat Communities of Practice" }, "datePublished": "2020-08-20T10:18:51-05:00", "dateModified": "2021-08-02T19:33:25-05:00", "publisher": { "@type": "Organization", "name": "Red Hat Communities of Practice", "logo": { "@type": "ImageObject", "url": "https://avatars.githubusercontent.com/u/21339385?v=4" } }, "description": "Premigration testing Installing MTC Install MTC on your source and target clusters: Check the migration prerequisites. Install MTC on the source an..." } </script> <link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="prev" href="/openshift-migration-best-practices/02-cluster-health-checks.html"><link rel="next" href="/openshift-migration-best-practices/04-running-the-migration.html"><link rel="canonical" href="/openshift-migration-best-practices/03-pre-migration-testing.html"><link rel="icon" type="image/svg+xml" href="/openshift-migration-best-practices/assets/images/favicon.svg"><link rel="icon" type="image/png" href="/openshift-migration-best-practices/assets/images/favicon-16x16.png" sizes="16x16"> <link rel="icon" type="image/png" href="/openshift-migration-best-practices/assets/images/favicon-32x32.png" sizes="32x32"> <link rel="icon" type="image/png" href="/openshift-migration-best-practices/assets/images/favicon-96x96.png" sizes="96x96"><link rel="mask-icon" href="/openshift-migration-best-practices/assets/images/favicon.svg" color="#2980b9"><link rel="apple-touch-icon" href="/openshift-migration-best-practices/assets/images/apple-touch-icon-300x300.jpg"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/rundocs/jekyll-rtd-theme@2.0.10/assets/css/theme.min.css"><script> window.ui = { title: "OpenShift Migration Best Practices", baseurl: "/openshift-migration-best-practices", i18n: { search_results: "Search Results", search_results_found: "Search finished, found # page(s) matching the search query.", search_results_not_found: "Your search did not match any documents, please make sure that all characters are spelled correctly!" } }; </script> </head> <body class="container"><div class="sidebar-wrap overflow-hidden"> <div class="sidebar height-full overflow-y-scroll overflow-x-hidden"> <div class="header d-flex flex-column p-3 text-center"> <div class="title pb-1"> <a class="h4 no-underline py-1 px-2 rounded-1" href="/openshift-migration-best-practices/" title="Best practices for migrating from OpenShift 3 to 4"> <i class="fa fa-home"></i> OpenShift Migration Best Practices </a> </div> <span class="version"></span> <form class="search pt-2" action="/openshift-migration-best-practices/search.html" method="get" autocomplete="off"> <input class="form-control input-block input-sm" type="text" name="q" placeholder="Search docs..."> </form> </div> <div class="toctree py-2" data-spy="affix" role="navigation" aria-label="main navigation"> <ul> <li class="toc level-1 " data-sort="" data-level="1"> <a class="d-flex flex-items-baseline " href="/openshift-migration-best-practices/01-planning.html">Planning</a> </li> <li class="toc level-1 " data-sort="" data-level="1"> <a class="d-flex flex-items-baseline " href="/openshift-migration-best-practices/02-cluster-health-checks.html">Cluster health checks</a> </li> <li class="toc level-1 current" data-sort="" data-level="1"> <a class="d-flex flex-items-baseline current" href="/openshift-migration-best-practices/03-pre-migration-testing.html">Premigration testing</a> </li> <li class="toc level-1 " data-sort="" data-level="1"> <a class="d-flex flex-items-baseline " href="/openshift-migration-best-practices/04-running-the-migration.html">Running the migration</a> </li> <li class="toc level-1 " data-sort="" data-level="1"> <a class="d-flex flex-items-baseline " href="/openshift-migration-best-practices/05-troubleshooting.html">Troubleshooting</a> </li> <li class="toc level-1 " data-sort="" data-level="1"> <a class="d-flex flex-items-baseline " href="/openshift-migration-best-practices/06-post-migration-considerations.html">Postmigration considerations</a> </li> </ul> </div> </div> </div> <div class="content-wrap"> <div class="header d-flex flex-justify-between p-2 hide-lg hide-xl" aria-label="top navigation"> <button id="toggle" aria-label="Toggle menu" class="btn-octicon p-2 m-0 text-white" type="button"> <i class="fa fa-bars"></i> </button> <div class="title flex-1 d-flex flex-justify-center"> <a class="h4 no-underline py-1 px-2 rounded-1" href="/openshift-migration-best-practices/">OpenShift Migration Best Practices</a> </div> </div> <div class="content p-3 p-sm-5"> <div class="navigation-top d-flex flex-justify-between"> <ul class="breadcrumb" role="navigation" aria-label="breadcrumbs navigation"> <li class="breadcrumb-item"> <a class="no-underline" href="/openshift-migration-best-practices/" title="/"> <i class="fa fa-home"></i> </a> </li><li class="breadcrumb-item" aria-current="page">03-pre-migration-testing.md</li></ul> </a> </div> <hr> <div role="main" itemscope="itemscope" itemtype="https://schema.org/Article"> <div class="markdown-body" itemprop="articleBody"> <h1 id="premigration-testing">Premigration testing</h1> <h2 id="installing-mtc">Installing MTC</h2> <p>Install MTC on your source and target clusters:</p> <ul> <li>Check the <a href="https://docs.openshift.com/container-platform/4.7/migration/migrating_3_4/migrating-application-workloads-3-4.html#migration-prerequisites_migrating-3-4">migration prerequisites</a>.</li> <li><a href="https://docs.openshift.com/container-platform/4.7/migration/migrating_3_4/deploying-cam-3-4.html">Install MTC</a> on the source and target clusters.</li> <li><a href="https://docs.openshift.com/container-platform/4.7/migration/migrating_3_4/configuring-replication-repository-3-4.html">Configure a replication repository</a>.</li> </ul> <p>The following diagram describes how MTC uses Velero and Restic to back up data from the source cluster to the replication repository and then restores data from the replication repository to the target cluster:</p> <p><img src="./images/mtc-architecture.png" alt="MTC Architecture" /></p> <h2 id="ensuring-same-mtc-versions">Ensuring same MTC versions</h2> <p>The same MTC z-stream version must be installed on the source and target clusters.</p> <p>Download and re-install the MTC Operator on the OpenShift 3 cluster just before you run a migration to ensure that you have the latest version.</p> <p>The Operator Lifecycle Manager (OLM) pushes MTC Operator updates to the OpenShift 4 cluster automatically. On the OpenShift 3 cluster, however, the MTC Operator is installed manually and is not updated automatically.</p> <h2 id="checking-olm-managed-setting">Checking ‘OLM Managed' setting</h2> <p>In the web console, check the ‘OLM Managed' setting in the ‘MigrationController' manifest of each cluster:</p> <ul> <li>OpenShift 4 uses OLM: <div class="language-yaml highlighter-rouge notranslate"><div class="highlight"><pre class="highlight"><code><span class="na">olm_managed</span><span class="pi">:</span> <span class="no">true</span>
</code></pre>  </div> </div> </li> <li>OpenShift 3 does not use OLM: <div class="language-yaml highlighter-rouge notranslate"><div class="highlight"><pre class="highlight"><code><span class="na">olm_managed</span><span class="pi">:</span> <span class="no">false</span>
</code></pre>  </div> </div> </li> </ul> <h2 id="migrating-a-simple-application">Migrating a simple application</h2> <p>Migrate a simple application without a persistent volume (PV):</p> <ol> <li>Install a simple application without a PV on the source cluster.</li> <li><a href="https://docs.openshift.com/container-platform/4.7/migration/migrating_3_4/migrating-applications-with-cam-3-4.html">Migrate the application</a> to the target cluster. You do not need to stage the migration.</li> <li>Validate the application on the target cluster.</li> </ol> <h2 id="migrating-an-application-with-a-persistent-volume">Migrating an application with a persistent volume</h2> <p>Migrate an application with a PV:</p> <ol> <li>Install an application with an associated PV on the source cluster.</li> <li>Stage the migration one or more times. Staging reduces migration time and application downtime during migration.</li> <li>Migrate the application to the target cluster.</li> <li>Validate the application on the target cluster.</li> </ol> <h2 id="removing-a-migrated-application-namespace">Removing a migrated application namespace</h2> <p>If you are performing multiple test migrations, remove the migrated application namespace from the target cluster after each test.</p> </div> </div> <div class="navigation-bottom d-flex flex-justify-between py-3" role="navigation" aria-label="footer navigation"> <div class="prev"><a href="/openshift-migration-best-practices/02-cluster-health-checks.html" class="btn" title="Cluster health checks" accesskey="p" rel="prev"> <i class="fa fa-arrow-circle-left"></i> Previous </a></div> <div class="next"><a href="/openshift-migration-best-practices/04-running-the-migration.html" class="btn" title="Running the migration" accesskey="n" rel="next"> Next <i class="fa fa-arrow-circle-right"></i> </a></div> </div><hr> <div class="copyright text-center text-gray" role="contentinfo"> <i class="fa fa-copyright"></i> <span class="time">2020-2021,</span> <a class="text-gray" href="https://github.com/redhat-cop" rel="noreferrer" target="_blank">Red Hat Communities of Practice</a> Revision <a class="text-gray" href="https://github.com/redhat-cop/openshift-migration-best-practices/commit/5c0780b69338e12110ef830cf64ea9376cc6fbec" title="5c0780b69338e12110ef830cf64ea9376cc6fbec" rel="noreferrer" target="_blank">5c0780b</a> <br> <div class="generator"> Built with <a href="https://pages.github.com" rel="noreferrer" target="_blank" title="github-pages v209">GitHub Pages</a> using a <a href="https://github.com/rundocs/jekyll-rtd-theme" rel="noreferrer" target="_blank" title="jekyll-rtd-theme v2.0.10">theme</a> provided by <a href="https://rundocs.io" rel="noreferrer" target="_blank">RunDocs</a>. </div> </div> </div> </div> <div class="addons-wrap d-flex flex-column overflow-y-auto"> <div class="status d-flex flex-justify-between p-2"> <div class="title p-1"> <i class="fa fa-book"></i> OpenShift Migration Best Practices </div> <div class="branch p-1"> <span class="name"> gh-pages </span> <i class="fa fa-caret-down"></i> </div> </div> <div class="addons d-flex flex-column height-full p-2 d-none"> <dl> <dt>GitHub</dt> <dd> <a href="https://github.com/redhat-cop/openshift-migration-best-practices" title="Stars: 67"> <i class="fa fa-github"></i> Homepage </a> </dd> <dd> <a href="https://github.com/redhat-cop/openshift-migration-best-practices/issues" title="Open issues: 3"> <i class="fa fa-question-circle-o"></i> Issues </a> </dd> <dd> <a href="https://github.com/redhat-cop/openshift-migration-best-practices/zipball/gh-pages" title="Size: 4421 Kb"> <i class="fa fa-download"></i> Download </a> </dd> </dl> <hr> <div class="license f6 pb-2"> This <a href="/openshift-migration-best-practices/" title="OpenShift Migration Best Practices">Software</a> is under the terms of <a href="https://github.com/redhat-cop/openshift-migration-best-practices">The Unlicense</a>. </div> </div> </div> <script src="https://cdn.jsdelivr.net/gh/rundocs/jekyll-rtd-theme@2.0.10/assets/js/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/gh/rundocs/jekyll-rtd-theme@2.0.10/assets/js/theme.min.js"></script> </body> </html>